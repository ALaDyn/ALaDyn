#!/bin/bash

export CRAY_CPU_TARGET=mic-knl
module load PrgEnv-intel
module load intel
module load impi
module load boost/1.72.0
module load cmake

export CC=$INTEL_PATH/linux/bin/intel64/icc
export CXX=$INTEL_PATH/linux/bin/intel64/icpc
export FC=$INTEL_PATH/linux/bin/intel64/ifort
export CLINKER=$CXX

mkdir -p build ; cd build
cmake .. -DCORI_KNL:BOOL=TRUE -DCMAKE_LINKER=$CLINKER -DBoost_NO_BOOST_CMAKE=ON -DCMAKE_Fortran_COMPILER=$FC
cmake --build . --target install -- -j8
cd ..
